<html layout:decorate="~{common/layout}">
<div layout:fragment="content">
  <link rel="stylesheet" th:href="@{/css/EGG/equipment.css}"/>

  <div id="modalBtn">
    <button sec:authorize = "hasRole('ADMIN')" type="button" id="modal_open">장비 정보 등록</button>
  </div>
  <div id="modal1" tabindex="-1" role="dialog">
    <div class="modal_content">
      <h2>신규 유저 정보 등록 창</h2>
      <form action="/EggSet/save" method="post">
        <!-- action 속성 : 목적지~어디로 보낼것이냐~(서버주소), method 속성 : http request method(get//주소창에 보이고, post//주소창에 안보인다) -->
        <!-- 얘들은 한 글에 대한 세트 데이터기 때문에, dto 클래스 객체로 담아서 코드를 줄이고 효율적으로 관리 -->
        <div>
          팀: <select class="form-select" name="team">
          <option value="">==팀 종류 선택==</option>
          <option th:each="team : ${teamList}" th:value="${team.teamName}"
                  th:text="${team.teamName}"></option>
        </select>
        </div>
        플레이어: <input type="text" name="player"> <br>
        <div>
          마우스: <select class="form-select" name="mouse">
          <option value="">==마우스 종류 선택==</option>
          <option th:each="mouse : ${mouseList}" th:value="${mouse.mouseName}"
                  th:text="${mouse.mouseName}"></option>
        </select>
        </div>
        Hz: <input type="text" name="hz"> <br>
        DPI: <input type="text" name="dpi"> <br>
        감도: <input type="text" name="sens"> <br>
        eDPI: <input type="text" name="edpi"> <br>
        조준감도: <input type="text" name="scopedsens"> <br>
        <div>
          모니터: <select class="form-select" name="monitor">
          <option value="">==모니터 종류 선택==</option>
          <option th:each="monitor : ${monitorList}" th:value="${monitor.monitorName}"
                  th:text="${monitor.monitorName}"></option>
        </select>
        </div>
        해상도: <input type="text" name="resolution"> <br>
        <div>
          그래픽카드: <select class="form-select" name="gpu">
          <option value="">==그래픽카드 종류 선택==</option>
          <option th:each="gpu : ${gpuList}" th:value="${gpu.gpuName}"
                  th:text="${gpu.gpuName}"></option>
        </select>
        </div>
        <div>
          마우스패드: <select class="form-select" name="mousepad">
          <option value="">==마우스패드 종류 선택==</option>
          <option th:each="mousepad : ${mousepadList}" th:value="${mousepad.mousepadName}"
                  th:text="${mousepad.mousepadName}"></option>
        </select>
        </div>
        <div>
          키보드: <select class="form-select" name="keyboard">
          <option value="">==키보드 종류 선택==</option>
          <option th:each="keyboard : ${keyBoardList}" th:value="${keyboard.keyboardName}"
                  th:text="${keyboard.keyboardName}"></option>
        </select>
        </div>
        <div>
          헤드셋: <select class="form-select" name="headset">
          <option value="">==헤드셋 종류 선택==</option>
          <option th:each="headset : ${headsetList}" th:value="${headset.headsetName}"
                  th:text="${headset.headsetName}"></option>
        </select>
        </div>
        <input type="submit" value="등록">
        <button type="button" id="modal_close">닫기</button>
      </form>
    </div>
    <div class="modal_layer"></div>
  </div>
  <div id="modal2" tabindex="-1" role="dialog">
    <div class="modal_content">

      <h2>유저 장비 정보 업데이트 창</h2>
      <form action="/EggSet/update" method="post">
        <div>
          팀: <select class="form-select" name="team">
          <option value="">==팀 종류 선택==</option>
          <option th:each="team : ${teamList}" th:value="${team.teamName}"
                  th:text="${team.teamName}"></option>
        </select>
        </div>
        <span>플레이어 : </span> <span id="modal-inner-name"></span>
        <input type="hidden" id="hidden_update_user_name" name="updateUserName">
        <div>
          마우스: <select class="form-select" name="mouse">
          <option value="">==마우스 종류 선택==</option>
          <option th:each="mouse : ${mouseList}" th:value="${mouse.mouseName}"
                  th:text="${mouse.mouseName}"></option>
        </select>
        </div>
        Hz: <input type="text" name="hz"> <br>
        DPI: <input type="text" name="dpi"> <br>
        감도: <input type="text" name="sens"> <br>
        eDPI: <input type="text" name="edpi"> <br>
        조준감도: <input type="text" name="scopedsens"> <br>
        <div>
          모니터: <select class="form-select" name="monitor">
          <option value="">==모니터 종류 선택==</option>
          <option th:each="monitor : ${monitorList}" th:value="${monitor.monitorName}"
                  th:text="${monitor.monitorName}"></option>
        </select>
        </div>
        해상도: <input type="text" name="resolution"> <br>
        <div>
          그래픽카드: <select class="form-select" name="gpu">
          <option value="">==그래픽카드 종류 선택==</option>
          <option th:each="gpu : ${gpuList}" th:value="${gpu.gpuName}"
                  th:text="${gpu.gpuName}"></option>
        </select>
        </div>
        <div>
          마우스패드: <select class="form-select" name="mousepad">
          <option value="">==마우스패드 종류 선택==</option>
          <option th:each="mousepad : ${mousepadList}" th:value="${mousepad.mousepadName}"
                  th:text="${mousepad.mousepadName}"></option>
        </select>
        </div>
        <div>
          키보드: <select class="form-select" name="keyboard">
          <option value="">==키보드 종류 선택==</option>
          <option th:each="keyboard : ${keyBoardList}" th:value="${keyboard.keyboardName}"
                  th:text="${keyboard.keyboardName}"></option>
        </select>
        </div>
        <div>
          헤드셋: <select class="form-select" name="headset">
          <option value="">==헤드셋 종류 선택==</option>
          <option th:each="headset : ${headsetList}" th:value="${headset.headsetName}"
                  th:text="${headset.headsetName}"></option>
        </select>
        </div>
        <input type="submit" value="등록">
        <button type="button" id="modal_update_close">닫기</button>
      </form>
    </div>
    <div class="modal_layer"></div>
  </div>
  <table>
    <tr>
      <td>Id</td>
      <td>팀</td>
      <td>플레이어</td>
      <td>마우스</td>
      <td>Hz</td>
      <td>DPI</td>
      <td>감도</td>
      <td>eDPI</td>
      <td>조준감도</td>
      <td>모니터</td>
      <td>해상도</td>
      <td>그래픽카드</td>
      <td>마우스패드</td>
      <td>키보드</td>
      <td>헤드셋</td>
    </tr>
    <!--th:each는 for each처럼 생각하면 된다.-->
    <!--board라는 변수로 boardList에 하나씩 접근을 하는것-->
    <tr th:each="board: ${eggSetList}">
      <td>
        <div id="modal_update_open" class="modal_update_open"
             style=" font-weight: bold; font-size: large"
             th:text="${board.id}"></div>
      </td>
      <td th:text="${board.team}"></td>
      <td th:text="${board.player}"></td>
      <td th:text="${board.mouse}"></td>
      <td th:text="${board.hz}"></td>
      <td th:text="${board.dpi}"></td>
      <td th:text="${board.sens}"></td>
      <td th:text="${board.edpi}"></td>
      <td th:text="${board.scopedsens}"></td>
      <td th:text="${board.monitor}"></td>
      <td th:text="${board.resolution}"></td>
      <td th:text="${board.gpu}"></td>
      <td th:text="${board.mousepad}"></td>
      <td th:text="${board.keyboard}"></td>
      <td th:text="${board.headset}"></td>
    </tr>
  </table>
  <script>

    document.getElementById("modal_open").onclick = function () {
      document.getElementById("modal1").style.display = "block";
    }
    document.getElementById("modal_close").onclick = function () {
      document.getElementById("modal1").style.display = "none";
    }

    let modalUpdateOpen = document.querySelectorAll(".modal_update_open");

    for (let i = 0; i < modalUpdateOpen.length; i++) {
      modalUpdateOpen[i].onclick = function () {
        let id = $(this).text();
        $.ajax({
          type: "GET",
          url: "EggSet/selectById?id=" + id,

          success: function (data) {
            const parsing = JSON.parse(data);
            console.log("이름 : " + parsing.player);
            $("#modal-inner-name").text(parsing.player);
            $("#hidden_update_user_name").val(parsing.player);
          }

        });
        document.getElementById("modal2").style.display = "block";
      }
    }

    document.getElementById("modal_update_close").onclick = function () {
      document.getElementById("modal2").style.display = "none";
    }


  </script>
</div>
</html>